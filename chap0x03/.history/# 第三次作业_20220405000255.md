# 第三次作业
---
## 作业要求

* 如何添加一个用户并使其具备sudo执行程序的权限?
* 如何将一个用户添加到一个用户组?
* 如何查看当前系统的分区表和文件系统详细信息?
* 如何实现开机自动挂载Virtualbox的共享目录分区?
* 基于LVM(逻辑分卷管理)的分区如何实现动态扩容和缩减容量?
* 如何通过systemd设置实现在网络连通时运行一个指定脚本,在网络断开时运行另一个脚本?
* 如何通过systemd设置实现一个脚本在任何情况下被杀死之后会立即重新启动?实现 ***杀不死?***
---

## 实验
### 实验过程
* 如何添加一个用户并使其具备sudo执行程序的权限?
    - 首先输入命令创建新用户
        ```bash
        sudo adduser 用户名
        ```
        ![](图片/1.1.png)
    - 给用户赋予sudo执行权限
        ```bash
        sudo usermod -G sudo username 
        ```
        验证`sudo`权限

        ![](图片/1.2.png)
<br>

* 如何将一个用户添加到一个用户组?
    - 先创建一个新的用户组，然后输入命令将用户添加到用户组
        ```bash
        usermod -a -G 组名 用户名
        ```
<br>

* 如何查看当前系统的分区表和文件系统详细信息?
    - 输入如下命令
        ```bash
        sudo lsblk
        ```
        ![](图片/3.1.png)
<br>

* 如何实现开机自动挂载Virtualbox的共享目录分区?
    - 首先在设置中配置好需要共享的文件
        ![](图片/4.1.png)
    - 然后在终端新建文件夹
        ```bash
        sudo mkdir /mnt/sharedfile
        ```
    - 进行挂载命令
        ```bash
        sudo mount -t vboxsf ubuntushare /mnt/sharedfile/
        ```
    - 编辑`/etc/fstab`文件，将如下命令添加，实现每次开机自动挂载
        ```bash
        ubuntushare 
        ```
        ![](图片/4.2.png)

* 基于LVM(逻辑分卷管理)的分区如何实现动态扩容和缩减容量?
    - 按照操作步骤设置好LVM分区
        ![](图片/5.1.png)
        动态扩容
        ```bash
        lvextend -L +容量 分区路径
        ```
        动态缩减
        ```bash
        lvreduce -L -容量 分区路径
        ```
        ![](图片/6.1.png)
<br>

* 如何通过systemd设置实现在网络连通时运行一个指定脚本,在网络断开时运行另一个脚本?
    - 首先编写了两个简单的脚本`check.sh`和`stop.sh`作为测试
    - 然后编辑配置文件
        ![](图片/7.1.png)
    - 检验
        ![](图片/7.2.png)
<br>

* 如何通过systemd设置实现一个脚本在任何情况下被杀死之后会立即重新启动?实现 ***杀不死？***
    - 重新编辑服务配置文件，在文件中添加如下内容
        ![](图片/7.3.png)
    - 修改配置文件后重启，验证是否实现
        ![](图片/74..png)


### 遇到的问题
* 如何实现开机自动挂载Virtualbox的共享目录分区?
    - 遇到的问题1:在输入挂载命令
        ```bash
        sudo mount -t vboxsf ubuntushare /mnt/sharedfile/
        ```
        时出现报错：**'ubuntushare' is not a valid block device**
    <br>
    - 解决办法：在搜索引擎搜索关键词“linux自动挂载 is not a valid block device”后参考文章[解决mount cifs时出现"is not a valid block device"的问题](https://blog.csdn.net/h952520296/article/details/82656074)，文章中提到可能是没有安装`mount.cifs`套件的原因，我代入我的问题后在终端输入`mount.vboxsf`果然未找到该命令。安装vboxsf后，问题解决，可以实现自动挂载。
<br>

* 如何通过systemd设置实现在网络连通时运行一个指定脚本,在网络断开时运行另一个脚本?
    - 遇到的问题1:编辑好配置文件后，执行命令
        ```sudo systemctl start check #
        ```